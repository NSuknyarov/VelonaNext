<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">

<dom-module id="velona-data">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <firebase-app
        auth-domain="nextv3-eac68.firebaseapp.com"
        database-url="https://nextv3-eac68.firebaseio.com"
        api-key="AIzaSyA0UEiF6fR7B_64rWTRuymp6GEc1uB9VQE">
    </firebase-app>
    <firebase-query
        id="queryCategories"
        path="/categories"
        data="{{dataCategories}}"
        order-by-child="parent"
        equal-to="[[categoryName]]">
    </firebase-query>

    <firebase-query
        id="queryCurrentCategory"
        path="/categories"
        data="{{dataCurrentCategory}}"
        order-by-child="title"
        equal-to="[[categoryName]]">
    </firebase-query>
    <firebase-query
        id="queryProducts"
        path="/products"
        data="{{dataProducts}}"
        order-by-child="categories/{{categoryID}}/name"
        equal-to="[[categoryName]]">
    </firebase-query>
  </template>
  <script>
    Polymer({
      is: 'velona-data',

      properties: {
        categoryName: String,
        categoryId: String,
        dataCategories: {
            type: Object,
            notify: true
        },
        dataCurrentCategory: {
            type: Object,
            notify: true,
            observer: '_getIdCurrentCategory'
        },
        dataProducts: {
            type: Object,
            notify: true
        }
      },

      _getIdCurrentCategory: function(newVal,oldVal) {

        this.notifySplices('dataCurrentCategory');
        console.log("----NEW------");
        console.log(newVal);
        console.log("----OLD------");
        console.log(oldVal);
        console.log(this.dataCurrentCategory);
        // var it = this.get(['dataCurrentCategory', 0202]);
        // var item = this.get(['dataCurrentCategory',1]);
        // var value = this.get('dataCurrentCategory.id');
        // console.log(this.dataCurrentCategory);
      //  this.categoryId = this.dataCurrentCategory.id;
      }

    });
  </script>
</dom-module>
